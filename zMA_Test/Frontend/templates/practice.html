<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

</head>
<body>
<h1>Practice!</h1>
<button id="idk" style='visibility:hidden' onclick="myFunction(this, {{ words }}, {{ status }}, 'idk','ik','flip')">I
    don't Know
</button>
<button id="ik" style='visibility:hidden' onclick="myFunction(this, {{ words }}, {{ status }}, 'idk','ik','flip')">I
    know
</button>
<button id="flip" onclick="flipCard(this, {{ words }}, 'flip', 'idk', 'ik')">Flip</button>

<!--
<input id='btn_1' type='button' value='button 1' onclick='javascript:myFunction({{ words }}"btn_1","btn_2")'/>
<input id='btn_2' type='button' value='button 2' style='visibility:hidden' onclick='javascript:flipCard({{ words }}"btn_2","btn_1")'/>
function show_hide(id2hide, id2show) {

}
-->

<p id="demo">{{ words[0][1] }}</p>

<script>
    var globalWords = [];
    var globalStatus = [];
    var isFirstWord = false, isFirstStatus = false;

    function wordlist_manipulation(id, currentIsKnow, currentWord) {

        if (globalStatus[id] === "red") {
            if (currentIsKnow === false) {
                globalStatus[id] = "red";
                globalWords.push(currentWord);
            }
            else {
                globalStatus[id] = "yellow";
                //words.append(currentWord);
            }
        }
        else if (globalStatus[id] === "yellow") {
            if (currentIsKnow === false) {
                globalStatus[id] = "yellow";
            }
            else {
                globalStatus[id] = "green";
                globalWords.splice(globalWords.indexOf(currentWord), 1);
                console.log("delete ", globalWords.indexOf(currentWord));
            }
        }
        else if (globalStatus[id] === "green") {
            console.log("delete ", globalWords.indexOf(currentWord));
            globalWords.splice(globalWords.indexOf(currentWord), 1);
        }
        console.log("printing from manipulation ", id, globalStatus[id], globalWords.length);

    }

    function myFunction(source, words, status, id2hide, id3hide, id2show) {

        console.log("life knife wife ", source.id, globalWords.length, isFirstWord, isFirstStatus);
        if (globalStatus.length === 0 && isFirstStatus === false) {
            globalStatus = status;
            isFirstStatus = true;
        }
        if (globalWords === 0 && isFirstWord === true) {
            document.getElementById(id2hide).style.visibility = 'hidden'
            document.getElementById(id3hide).style.visibility = 'hidden';
            document.getElementById(id2show).style.visibility = 'hidden';
        }
        else {
            var i;
            var x = document.getElementById("demo");
            var index = 0;
            for (i = 0; i < globalWords.length - 1; i++) {
                var y = globalWords[i][1];
                var z = globalWords[i][2][0];
                if (x.innerHTML === y) {
                    index = i + 1;

                }
                else if (x.innerHTML === z) {
                    index = i + 1;
                }
            }
            var final = globalWords[index][1];


            /*$.ajax({
                url: '/clicked',
                data: {'id':source.id.toString(), 'words':words, 'wordid':words[index][0]},
                dataType: 'json',
                type: 'POST',
                success: function (response) {

                    console.log(response.status);
                },
                error: function (error) {
                    //document.getElementById(id+"_text").innerHTML='Translation Not Available'
                }
            });
            */
            if (source.id === "ik") {
                wordlist_manipulation(globalWords[index][0], true, globalWords[index][1]);
            }
            else if (source.id === "idk") {
                wordlist_manipulation(globalWords[index][0], false, globalWords[index][1]);
            }
            document.getElementById("demo").innerHTML = final;
            document.getElementById(id2hide).style.visibility = 'hidden'
            document.getElementById(id3hide).style.visibility = 'hidden';
            document.getElementById(id2show).style.visibility = 'visible';
        }


    }

    function flipCard(source, words, id2hide, id2show, id3show) {
        if (globalWords.length === 0 && isFirstWord == false) {
            globalWords = words;
            isFirstWord = true;
        }
        if (globalWords.length === 0 && isFirstWord === true) {
            document.getElementById("demo").innerHTML = "Congratulations. You have learned all the words!"
            document.getElementById(id2hide).style.visibility = 'hidden';
            document.getElementById(id2show).style.visibility = 'hidden';
            document.getElementById(id3show).style.visibility = 'hidden';
        }
        else {
            var i;
            var x = document.getElementById("demo");
            var final = x.innerHTML;
            for (i = 0; i < globalWords.length; i++) {
                var y = globalWords[i][1];
                var z = globalWords[i][2][0];
                //console.log("mmm",y, z, final, y===final, z===final)
                if (final === z) {
                    final = y;
                }
                else if (final === y) {
                    final = z;
                }

            }

            document.getElementById("demo").innerHTML = final;
            document.getElementById(id2hide).style.visibility = 'hidden';
            document.getElementById(id2show).style.visibility = 'visible';
            document.getElementById(id3show).style.visibility = 'visible';
        }


    }

</script>


</body>
</html>